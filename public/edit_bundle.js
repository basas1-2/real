document.addEventListener('DOMContentLoaded', async ()=>{ const id = new URLSearchParams(location.search).get('id'); const res0 = await fetch('/blogs/api/'+id); const p = await res0.json(); if(p._id){ document.querySelector('[name=title]').value=p.title; document.querySelector('[name=content]').value=p.content; } document.getElementById('editForm').addEventListener('submit', async (e)=>{ e.preventDefault(); const form = new FormData(e.target); const r = await fetch('/blogs/api/'+id, { method:'PUT', body: form, credentials:'same-origin' }); const j = await r.json(); if(j._id) location.href='/post.html?id='+j._id; else document.getElementById('msg').innerText = j.error||'Update failed'; }); });
