document.addEventListener('DOMContentLoaded', async ()=>{ const username = new URLSearchParams(location.search).get('username'); if(!username) return document.getElementById('profileHeader').textContent='No username'; const res = await fetch('/auth/profile/'+encodeURIComponent(username)); const j = await res.json(); if(j.error) return document.getElementById('profileHeader').textContent=j.error; const header = document.getElementById('profileHeader'); header.innerHTML = '<div style="display:flex;align-items:center;gap:12px"><img src="'+(j.user.avatarPath||'/images/avatar_placeholder.png')+'" height="80"/><div><h2>'+j.user.displayName+'</h2><small class="gray">@'+j.user.username+'</small></div></div>'; const feed = document.getElementById('feed'); feed.innerHTML=''; j.posts.forEach(p=>{ const el = document.createElement('div'); el.className='post-card'; el.innerHTML = '<h3>'+ (p.title||'') +'</h3><p>' + (p.content? (p.content.length>300? p.content.substring(0,300)+'...': p.content):'') + '</p><a href="/post.html?id='+p._id+'">See Post</a>'; feed.appendChild(el); }); });
