document.addEventListener('DOMContentLoaded', async ()=>{ const res = await fetch('/blogs/api/list'); const posts = await res.json(); const feed = document.getElementById('feed'); const tpl = document.getElementById('post-template'); feed.innerHTML=''; posts.forEach(p=>{ const node = tpl.content.cloneNode(true); node.querySelector('.author-link').textContent = p.author.displayName || p.author.username; node.querySelector('.author-link').href = '/profile.html?username='+encodeURIComponent(p.author.username); node.querySelector('.avatar').src = p.author.avatarPath || '/images/avatar_placeholder.png'; node.querySelector('.time').textContent = new Date(p.createdAt).toLocaleString(); node.querySelector('.post-title').textContent = p.title||''; node.querySelector('.post-content').textContent = p.content||''; if(p.imagePath) node.querySelector('.post-image').innerHTML = '<img src="'+p.imagePath+'"/>'; feed.appendChild(node); }); });
